<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bookmarklet Installer v4</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; padding: 40px; line-height: 1.6; max-width: 800px; margin: 0 auto; background-color: #f8f9fa; color: #202124; }
        .card { background: white; padding: 40px; border-radius: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24); }
        h1 { color: #1a73e8; margin-top: 0; font-size: 24px; }
        .bookmarklet-button {
            display: inline-flex;
            align-items: center;
            background-color: #1a73e8;
            color: white;
            padding: 14px 28px;
            text-decoration: none;
            border-radius: 100px;
            font-weight: 600;
            box-shadow: 0 4px 6px rgba(26,115,232,0.3);
            cursor: move;
            transition: all 0.2s;
            font-size: 16px;
        }
        .bookmarklet-button:hover { background-color: #174ea6; box-shadow: 0 6px 10px rgba(26,115,232,0.4); transform: translateY(-1px); }
        .steps { margin: 24px 0; padding-left: 24px; color: #5f6368; }
        .steps li { margin-bottom: 12px; }
        .highlight { color: #d93025; font-weight: bold; }
    </style>
</head>
<body>
    <div class="card">
        <h1>QA Helper Tool v4 (Google Docs Fix)</h1>
        <p>This version uses <strong>Trusted Types</strong> compatible code so it works inside Google Docs, Sheets, and Gmail.</p>
        
        <h3>Installation Instructions</h3>
        <ol class="steps">
            <li><span class="highlight">Important:</span> If you don't see "v4" on the button, press <strong>Ctrl + Shift + R</strong> (Windows) or <strong>Cmd + Shift + R</strong> (Mac).</li>
            <li>Delete your old bookmark.</li>
            <li>Drag the button below to your Bookmarks Bar.</li>
        </ol>

        <div style="text-align: center; margin: 50px 0;">
            <!-- 
               UPDATED CODE v4:
               - No innerHTML usage.
               - Compatible with Strict CSP (Content Security Policy).
            -->
            <a class="bookmarklet-button" href="javascript:(function(){const ID='qa-v4-trusted';if(document.getElementById(ID))return;const h=document.createElement('div');h.id=ID;Object.assign(h.style,{all:'initial',zIndex:2147483647,position:'fixed',top:0,left:0});document.body.appendChild(h);const s=h.attachShadow({mode:'open'});const st=document.createElement('style');st.textContent=':host{all:initial;z-index:2147483647}*{box-sizing:border-box;font-family:sans-serif}.m{position:fixed;bottom:20px;right:20px;width:300px;background:#fff;color:#333;box-shadow:0 8px 24px rgba(0,0,0,0.25);border-radius:12px;border:1px solid #ccc;display:flex;flex-direction:column;overflow:hidden;font-size:14px;line-height:1.5}.h{background:#f1f3f4;padding:12px 16px;cursor:move;border-bottom:1px solid #dadce0;display:flex;justify-content:space-between;align-items:center;user-select:none;font-weight:600;color:#202124}.b{padding:16px;color:#3c4043}.f{padding:12px 16px;border-top:1px solid #eee;text-align:right;background:#fff}button{background:#fff;border:1px solid #dadce0;color:#3c4043;padding:6px 16px;border-radius:4px;cursor:pointer;font-size:14px;margin-left:8px;font-weight:500}button:hover{background:#f8f9fa;border-color:#dadce0}button.p{background:#1a73e8;color:#fff;border:none}button.p:hover{background:#1557b0}.c{cursor:pointer;font-size:20px;line-height:1;padding:4px;border-radius:50%;color:#5f6368}.c:hover{background:rgba(0,0,0,0.1);color:#202124}';s.appendChild(st);const m=document.createElement('div');m.className='m';const hd=document.createElement('div');hd.className='h';const tt=document.createElement('span');tt.textContent='QA Helper v4';const cl=document.createElement('span');cl.className='c';cl.textContent='Ã—';hd.append(tt,cl);const bd=document.createElement('div');bd.className='b';const p1=document.createElement('p');p1.textContent='I work in Google Docs!';p1.style.marginTop='0';const p2=document.createElement('p');p2.textContent='Trusted Types Safe.';p2.style.marginBottom='0';bd.append(p1,p2);const ft=document.createElement('div');ft.className='f';const b1=document.createElement('button');b1.textContent='Cancel';const b2=document.createElement('button');b2.className='p';b2.textContent='Save';ft.append(b1,b2);m.append(hd,bd,ft);s.appendChild(m);const rm=()=>h.remove();cl.onclick=rm;b1.onclick=rm;let isD=false,sX,sY,iL,iT;hd.addEventListener('mousedown',e=>{isD=true;const r=m.getBoundingClientRect();m.style.bottom='auto';m.style.right='auto';m.style.left=r.left+'px';m.style.top=r.top+'px';sX=e.clientX;sY=e.clientY;iL=r.left;iT=r.top;e.preventDefault();});document.addEventListener('mousemove',e=>{if(!isD)return;const dx=e.clientX-sX;const dy=e.clientY-sY;m.style.left=(iL+dx)+'px';m.style.top=(iT+dy)+'px';});document.addEventListener('mouseup',()=>isD=false);})();">
                QA Helper v4
            </a>
        </div>
        
        <p><small>Works on Google Docs, Sheets, Gmail, and GitHub.</small></p>
    </div>
</body>
</html>
