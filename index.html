<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QA Form Installer</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; padding: 40px; line-height: 1.6; max-width: 800px; margin: 0 auto; background-color: #f8f9fa; color: #202124; }
        .card { background: white; padding: 40px; border-radius: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24); }
        h1 { color: #1a73e8; margin-top: 0; font-size: 24px; }
        .bookmarklet-button {
            display: inline-flex;
            align-items: center;
            background-color: #1a73e8;
            color: white;
            padding: 14px 28px;
            text-decoration: none;
            border-radius: 100px;
            font-weight: 600;
            box-shadow: 0 4px 6px rgba(26,115,232,0.3);
            cursor: move;
            transition: all 0.2s;
            font-size: 16px;
        }
        .bookmarklet-button:hover { background-color: #174ea6; box-shadow: 0 6px 10px rgba(26,115,232,0.4); transform: translateY(-1px); }
        .steps { margin: 24px 0; padding-left: 24px; color: #5f6368; }
        .steps li { margin-bottom: 12px; }
        .highlight { color: #d93025; font-weight: bold; }
    </style>
</head>
<body>
    <div class="card">
        <h1>QA Form Installer</h1>
        <p>This version uses <strong>Trusted Types</strong> compatible code so it works inside Google Docs, Sheets, and Gmail.</p>
        
        <h3>Installation Instructions</h3>
        <ol class="steps">
            <li><span class="highlight">Important:</span> If you don't see "QA Form" on the button, press <strong>Ctrl + Shift + R</strong> (Windows) or <strong>Cmd + Shift + R</strong> (Mac).</li>
            <li>Delete your old bookmark.</li>
            <li>Drag the button below to your Bookmarks Bar.</li>
        </ol>

        <div style="text-align: center; margin: 50px 0;">
            <a class="bookmarklet-button" href="javascript:(function(){const ID='qa-form-v4';if(document.getElementById(ID))return;const h=document.createElement('div');h.id=ID;Object.assign(h.style,{all:'initial',zIndex:2147483647,position:'fixed',top:0,left:0});document.body.appendChild(h);const s=h.attachShadow({mode:'open'});const st=document.createElement('style');st.textContent=':host{all:initial;z-index:2147483647}*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,Helvetica,Arial,sans-serif}.modal{position:fixed;bottom:20px;right:20px;width:320px;background:#fff;color:#333;box-shadow:0 8px 24px rgba(0,0,0,0.25);border-radius:12px;border:1px solid #ccc;display:flex;flex-direction:column;overflow:hidden;font-size:14px;line-height:1.5}.header{background:#f1f3f4;padding:12px 16px;cursor:move;border-bottom:1px solid #dadce0;display:flex;justify-content:space-between;align-items:center;user-select:none;font-weight:600;color:#202124}.body{padding:16px;color:#3c4043;max-height:400px;overflow-y:auto}.footer{padding:12px 16px;border-top:1px solid #eee;text-align:right;background:#fff}.expandable{border:1px solid #dadce0;border-radius:8px;margin-bottom:12px;overflow:hidden}.expandable-header{background:#f8f9fa;padding:10px 12px;cursor:pointer;font-weight:500;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #dadce0}.expandable-content{padding:12px}.btn-group{display:flex;gap:8px;margin-bottom:10px}.btn-group button{flex:1}button{background:#fff;border:1px solid #dadce0;color:#3c4043;padding:6px 16px;border-radius:4px;cursor:pointer;font-size:14px;font-weight:500;margin-left:8px}.btn-group button{margin-left:0}button:hover{background:#f8f9fa;border-color:#dadce0}button.primary{background:#1a73e8;color:#fff;border:none}button.primary:hover{background:#1557b0}button.active-yes{background:#e6f4ea;color:#137333;border-color:#ceead6}button.active-no{background:#fce8e6;color:#c5221f;border-color:#fad2cf}textarea{width:100%;border:1px solid #dadce0;border-radius:4px;padding:8px;font-size:13px;resize:vertical;min-height:80px;outline:none}textarea:focus{border-color:#1a73e8}.header-checkbox{width:16px;height:16px;cursor:pointer}.close-btn{cursor:pointer;font-size:20px;line-height:1;padding:4px;border-radius:50%;color:#5f6368}.close-btn:hover{background:rgba(0,0,0,0.1);color:#202124}';s.appendChild(st);const m=document.createElement('div');m.className='modal';const hd=document.createElement('div');hd.className='header';const t=document.createElement('span');t.textContent='QA Form';const c=document.createElement('span');c.className='close-btn';c.textContent='Ã—';hd.append(t,c);const b=document.createElement('div');b.className='body';const ex=document.createElement('div');ex.className='expandable';const eh=document.createElement('div');eh.className='expandable-header';const et=document.createElement('span');et.textContent='1. Greeting (Branding + Name)';const ch=document.createElement('input');ch.type='checkbox';ch.className='header-checkbox';ch.onclick=e=>e.stopPropagation();eh.append(et,ch);const ec=document.createElement('div');ec.className='expandable-content';ec.style.display='none';const bg=document.createElement('div');bg.className='btn-group';const by=document.createElement('button');by.textContent='Yes';const bn=document.createElement('button');bn.textContent='No';bg.append(by,bn);const ta=document.createElement('textarea');ta.placeholder='Add context here...';ec.append(bg,ta);ex.append(eh,ec);b.appendChild(ex);const f=document.createElement('div');f.className='footer';const bc=document.createElement('button');bc.textContent='Cancel';const bgn=document.createElement('button');bgn.className='primary';bgn.textContent='Generate';f.append(bc,bgn);m.append(hd,b,f);s.appendChild(m);const rm=()=>h.remove();c.onclick=rm;bc.onclick=rm;bgn.onclick=()=>alert('Report generated!');by.onclick=()=>{by.className='active-yes';bn.className=''};bn.onclick=()=>{bn.className='active-no';by.className=''};eh.onclick=()=>{const h=ec.style.display==='none';ec.style.display=h?'block':'none'};let d=false,sx,sy,il,it;hd.addEventListener('mousedown',e=>{d=true;const r=m.getBoundingClientRect();m.style.bottom='auto';m.style.right='auto';m.style.left=r.left+'px';m.style.top=r.top+'px';sx=e.clientX;sy=e.clientY;il=r.left;it=r.top;e.preventDefault()});document.addEventListener('mousemove',e=>{if(!d)return;const dx=e.clientX-sx,dy=e.clientY-sy;m.style.left=(il+dx)+'px';m.style.top=(it+dy)+'px'});document.addEventListener('mouseup',()=>d=false);})();">
                QA Form
            </a>
        </div>
        
        <p><small>Works on Google Docs, Sheets, Gmail, and GitHub.</small></p>
    </div>
</body>
</html>