<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bookmarklet Installer v3</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; padding: 40px; line-height: 1.6; max-width: 800px; margin: 0 auto; background-color: #f8f9fa; color: #202124; }
        .card { background: white; padding: 40px; border-radius: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24); }
        h1 { color: #1a73e8; margin-top: 0; font-size: 24px; }
        .bookmarklet-button {
            display: inline-flex;
            align-items: center;
            background-color: #1a73e8;
            color: white;
            padding: 14px 28px;
            text-decoration: none;
            border-radius: 100px;
            font-weight: 600;
            box-shadow: 0 4px 6px rgba(26,115,232,0.3);
            cursor: move;
            transition: all 0.2s;
            font-size: 16px;
        }
        .bookmarklet-button:hover { background-color: #174ea6; box-shadow: 0 6px 10px rgba(26,115,232,0.4); transform: translateY(-1px); }
        .steps { margin: 24px 0; padding-left: 24px; color: #5f6368; }
        .steps li { margin-bottom: 12px; }
        .highlight { color: #d93025; font-weight: bold; }
    </style>
</head>
<body>
    <div class="card">
        <h1>QA Helper Tool v3 (Fix)</h1>
        <p>This version includes a <strong>Strict Isolation Mode</strong> and improved <strong>Drag Logic</strong>.</p>
        
        <h3>Installation Instructions</h3>
        <ol class="steps">
            <li><span class="highlight">Important:</span> If you see "v2" on the button below, press <strong>Ctrl + Shift + R</strong> (Windows) or <strong>Cmd + Shift + R</strong> (Mac) to clear your cache.</li>
            <li>Delete your old bookmark.</li>
            <li>Drag the button below to your Bookmarks Bar.</li>
        </ol>

        <div style="text-align: center; margin: 50px 0;">
            <!-- 
               UPDATED CODE v3:
               - Uses host.style.all = 'initial' for max protection.
               - Calculates Rect for smoother dragging.
            -->
            <a class="bookmarklet-button" href="javascript:(function(){const ID='qa-shadow-root-v3';if(document.getElementById(ID))return;const h=document.createElement('div');h.id=ID;h.style.all='initial';h.style.zIndex=2147483647;h.style.position='fixed';h.style.top='0';h.style.left='0';document.body.appendChild(h);const s=h.attachShadow({mode:'open'});const st=document.createElement('style');st.textContent=':host{all:initial;z-index:2147483647}*{box-sizing:border-box;font-family:sans-serif}.m{position:fixed;bottom:20px;right:20px;width:300px;background:#fff;color:#333;box-shadow:0 8px 24px rgba(0,0,0,0.25);border-radius:12px;border:1px solid #ccc;display:flex;flex-direction:column;overflow:hidden;font-size:14px;line-height:1.5}.h{background:#f1f3f4;padding:12px 16px;cursor:move;border-bottom:1px solid #dadce0;display:flex;justify-content:space-between;align-items:center;user-select:none;font-weight:600;color:#202124}.b{padding:16px;color:#3c4043}.f{padding:12px 16px;border-top:1px solid #eee;text-align:right;background:#fff}button{background:#fff;border:1px solid #dadce0;color:#3c4043;padding:6px 16px;border-radius:4px;cursor:pointer;font-size:14px;margin-left:8px;font-weight:500}button:hover{background:#f8f9fa;border-color:#dadce0}button.p{background:#1a73e8;color:#fff;border:none}button.p:hover{background:#1557b0}.c{cursor:pointer;font-size:20px;line-height:1;padding:4px;border-radius:50%;color:#5f6368}.c:hover{background:rgba(0,0,0,0.1);color:#202124}';s.appendChild(st);const m=document.createElement('div');m.className='m';m.innerHTML='<div class=\'h\'><span>QA Helper v3</span><span class=\'c\'>&times;</span></div><div class=\'b\'><p style=\'margin-top:0\'>I am fully isolated.</p><p style=\'margin-bottom:0\'>Drag me around!</p></div><div class=\'f\'><button id=\'x\'>Cancel</button><button class=\'p\'>Save</button></div>';s.appendChild(m);const close=()=>h.remove();m.querySelector('.c').onclick=close;m.querySelector('#x').onclick=close;const head=m.querySelector('.h');let isD=false,sX,sY,iL,iT;head.addEventListener('mousedown',e=>{isD=true;const r=m.getBoundingClientRect();m.style.bottom='auto';m.style.right='auto';m.style.left=r.left+'px';m.style.top=r.top+'px';sX=e.clientX;sY=e.clientY;iL=r.left;iT=r.top;e.preventDefault();});document.addEventListener('mousemove',e=>{if(!isD)return;const dx=e.clientX-sX;const dy=e.clientY-sY;m.style.left=(iL+dx)+'px';m.style.top=(iT+dy)+'px';});document.addEventListener('mouseup',()=>isD=false);})();">
                QA Helper v3
            </a>
        </div>
        
        <p><small>Tested on Chrome, Firefox, Edge, and Safari.</small></p>
    </div>
</body>
</html>